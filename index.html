<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Levels Academy – Registration Form</title>

<!-- Font (optional, close enough to your UI) -->
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800&display=swap" rel="stylesheet">

<!-- intl-tel-input (for phone with country flag) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@19.5.6/build/css/intlTelInput.css"/>
<style>
  :root{
    --bg: #f4f7f7;
    --field-bg:#f1f3f3;          /* light gray field background */
    --mint:#bfe8de;              /* mint for Course */
    --label:#2b445b;             /* dark blue label */
    --text:#0f1f28;
    --btn:#273e53;               /* dark navy submit */
    --btn-text:#ffffff;
    --radius:26px;
    --radius-sm:18px;
    --shadow:0 8px 18px rgba(0,0,0,.06);
  }

  *{box-sizing:border-box}
  html,body{margin:0}
  body{
    font-family:"Nunito",ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
    color:var(--text);
    background:transparent; /* so it blends into Wix page */
  }

  .wrap{
    width:min(1200px, 100%);
    margin:0 auto;
    padding:20px 16px 28px;
  }

  /* Card container (optional subtle separation from page) */
  .card{
    background:transparent;
  }

  /* Form grid */
  form{
    display:grid;
    gap:18px 20px;
    grid-template-columns: repeat(12, 1fr);
  }

  /* Labels */
  .field label{
    display:block;
    font-size:14px;
    font-weight:700;
    color:var(--label);
    margin:0 0 8px;
  }

  /* Inputs */
  .input, select, textarea{
    width:100%;
    background:var(--field-bg);
    border:none;
    outline:none;
    border-radius:var(--radius);
    padding:18px 20px;
    font-size:16px;
    line-height:1.2;
    transition:box-shadow .2s ease, background .2s ease;
  }
  .input:focus, select:focus, textarea:focus{
    box-shadow:0 0 0 3px rgba(35,184,153,.15);
    background:#eef1f1;
  }

  /* Mint Course select */
  .select-mint{
    background:var(--mint);
  }

  /* Phone (intl-tel-input) needs square corners inside; we wrap it */
  .phone-wrap{
    background:var(--field-bg);
    border-radius:var(--radius);
    padding:10px 14px 10px 12px;
  }
  .phone-wrap:focus-within{
    box-shadow:0 0 0 3px rgba(35,184,153,.15);
    background:#eef1f1;
  }
  .phone{
    width:100%;
    border:none;
    background:transparent;
    outline:none;
    padding:8px 8px 8px 58px; /* space for flag */
    font-size:16px;
    line-height:1.3;
  }

  /* Submit */
  .actions{
    grid-column: 1 / -1;
    display:flex;
    justify-content:center;
    margin-top:6px;
  }
  button[type="submit"]{
    background:var(--btn);
    color:var(--btn-text);
    border:none;
    padding:16px 36px;
    font-size:18px;
    font-weight:800;
    border-radius:40px;
    cursor:pointer;
    box-shadow:var(--shadow);
    transition:transform .08s ease, opacity .2s ease;
  }
  button[type="submit"]:hover{ opacity:.95 }
  button[type="submit"]:active{ transform:translateY(1px) }
  button[disabled]{ opacity:.6; cursor:progress }

  /* Grid placements to mimic your layout */
  .fn   { grid-column: span 3; }
  .ln   { grid-column: span 3; }
  .age  { grid-column: span 3; }
  .mail { grid-column: span 3; }

  .phone{ grid-column: span 4; }
  .branch{grid-column: span 4; }
  .course{grid-column: span 12;} /* long mint bar */

  .msg  { grid-column: span 12; }
  textarea{ min-height:120px; border-radius:var(--radius-sm) }

  /* Labels with asterisk */
  .req::after{
    content:" *";
    color:#d04a4a;
    font-weight:800;
  }

  /* Small helper / error text */
  .error{
    grid-column: 1 / -1;
    color:#b23a3a;
    background:#fde7e7;
    border-radius:16px;
    padding:10px 14px;
    font-size:14px;
    display:none;
  }
  .success{
    grid-column: 1 / -1;
    color:#145c32;
    background:#e6f6ec;
    border-radius:16px;
    padding:10px 14px;
    font-size:14px;
    display:none;
  }

  /* Responsive */
  @media (max-width:1100px){
    .fn,.ln,.age,.mail{ grid-column: span 6; }
    .phone,.branch{ grid-column: span 6; }
  }
  @media (max-width:680px){
    form{ gap:14px }
    .fn,.ln,.age,.mail,
    .phone,.branch,
    .course,.msg{ grid-column: 1 / -1; }
    button[type="submit"]{ width:100% }
  }

  /* Remove default arrow background in Safari/iOS */
  select{
    -webkit-appearance:none;
    -moz-appearance:none;
    appearance:none;
    background-image: linear-gradient(45deg, transparent 50%, #2b445b 50%), 
                      linear-gradient(135deg, #2b445b 50%, transparent 50%);
    background-position: calc(100% - 24px) calc(1em + 4px), calc(100% - 18px) calc(1em + 4px);
    background-size: 6px 6px, 6px 6px;
    background-repeat: no-repeat;
    padding-right:40px;
  }

  /* Make the Course select look “taller / bolder” like your screenshot */
  .select-lg{
    padding-top:22px;
    padding-bottom:22px;
    font-weight:700;
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <form id="enrollForm" novalidate>
        <!-- First row -->
        <div class="field fn">
          <label class="req">First name</label>
          <input class="input" id="firstName" name="firstName" autocomplete="given-name" required />
        </div>

        <div class="field ln">
          <label class="req">Last name</label>
          <input class="input" id="lastName" name="lastName" autocomplete="family-name" required />
        </div>

        <div class="field age">
          <label class="req">Age</label>
          <input class="input" id="age" name="age" type="number" min="3" max="99" inputmode="numeric" required />
        </div>

        <div class="field mail">
          <label class="req">Email</label>
          <input class="input" id="email" name="email" type="email" autocomplete="email" required />
        </div>

        <!-- Second row -->
        <div class="field phone">
          <label class="req">Phone</label>
          <div class="phone-wrap">
            <input id="phone" class="phone" name="phone" type="tel" required />
          </div>
        </div>

        <div class="field branch">
          <label class="req">Branch</label>
          <select id="branch" name="branch" required>
            <option value="" selected disabled>Select a branch</option>
            <option>Vake</option>
            <option>Krtsanisi</option>
          </select>
        </div>

        <div class="field course">
          <label class="req">Course</label>
          <select id="course" name="course" class="select-mint select-lg" required>
            <option value="" selected disabled>Select a course</option>
            <optgroup label="Children & Teens">
              <option>Sunday School (age: 6–10)</option>
              <option>Saturday School (age: 6–10)</option>
              <option>General English for Children (age: 6–10)</option>
              <option>General English for Teenagers (age: 11–17)</option>
              <option>IELTS</option>
              <option>Private Lessons</option>
            </optgroup>
            <optgroup label="Adults">
              <option>FCE PET CAE</option>
              <option>Professional English</option>
              <option>General English for Adults</option>
            </optgroup>
          </select>
        </div>

        <!-- Message -->
        <div class="field msg">
          <label>Leave a message</label>
          <textarea id="message" name="message" placeholder=""></textarea>
        </div>

        <div id="err" class="error"></div>
        <div id="ok" class="success">Thank you! Your enrollment request has been sent.</div>

        <!-- Submit -->
        <div class="actions">
          <button id="submitBtn" type="submit">Enroll</button>
        </div>
      </form>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/intl-tel-input@19.5.6/build/js/intlTelInput.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/intl-tel-input@19.5.6/build/js/utils.js"></script>
  <script>
    /* =========================
       CONFIG
       =========================
       1) If you have a backend/webhook, put the URL here.
          We'll POST JSON to it on submit.
       2) If you embed this on Wix via an HTML iframe,
          you also get a postMessage event you can capture.
    */
    const WEBHOOK_URL = ""; // e.g. "https://your-server.tld/enroll"

    // Phone input with flag (default to Georgia)
    const phoneInput = document.getElementById('phone');
    const iti = window.intlTelInput(phoneInput, {
      initialCountry: "ge",
      utilsScript: "https://cdn.jsdelivr.net/npm/intl-tel-input@19.5.6/build/js/utils.js",
      separateDialCode: true,
      preferredCountries: ["ge","tr","ae","gb"],
    });

    const form = document.getElementById('enrollForm');
    const btn  = document.getElementById('submitBtn');
    const err  = document.getElementById('err');
    const ok   = document.getElementById('ok');

    function showError(msg){
      err.textContent = msg;
      err.style.display = 'block';
      ok.style.display = 'none';
    }
    function showSuccess(){
      err.style.display = 'none';
      ok.style.display = 'block';
    }

    function validEmail(v){
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      err.style.display = 'none';
      ok.style.display = 'none';

      // Collect
      const payload = {
        firstName: document.getElementById('firstName').value.trim(),
        lastName : document.getElementById('lastName').value.trim(),
        age      : document.getElementById('age').value.trim(),
        email    : document.getElementById('email').value.trim(),
        phone    : iti.getNumber(),     // full international format
        phoneCC  : iti.getSelectedCountryData()?.dialCode,
        branch   : document.getElementById('branch').value,
        course   : document.getElementById('course').value,
        message  : document.getElementById('message').value.trim(),
        ts       : new Date().toISOString()
      };

      // Minimal validation to mirror required UI
      if(!payload.firstName || !payload.lastName || !payload.age || !payload.email || !payload.branch || !payload.course){
        return showError("Please fill in all required fields.");
      }
      if(isNaN(Number(payload.age)) || Number(payload.age) < 3 || Number(payload.age) > 99){
        return showError("Please enter a valid age (3–99).");
      }
      if(!validEmail(payload.email)){
        return showError("Please enter a valid email address.");
      }
      if(!iti.isValidNumber()){
        return showError("Please enter a valid phone number.");
      }

      btn.disabled = true;

      try{
        // 1) Send to parent Wix page (capture with $w('#htmlComponent').onMessage)
        window.parent?.postMessage({ type: "levels-enroll", data: payload }, "*");

        // 2) Optional: send to your webhook
        if(WEBHOOK_URL){
          const res = await fetch(WEBHOOK_URL, {
            method: "POST",
            headers: { "Content-Type":"application/json" },
            body: JSON.stringify(payload)
          });
          if(!res.ok){
            throw new Error("Server error: " + res.status);
          }
        }

        // Reset & success note
        form.reset();
        iti.setCountry("ge");
        showSuccess();
      } catch (e){
        console.error(e);
        showError("Could not submit right now. Please try again.");
      } finally{
        btn.disabled = false;
      }
    });
  </script>
</body>
</html>
