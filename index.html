<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Levels Academy – Registration Form</title>

<!-- Red Hat Display (labels bold, inputs light) -->
<link href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@300;700;800&display=swap" rel="stylesheet">

<!-- intl-tel-input for phone -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@19.5.6/build/css/intlTelInput.css"/>

<style>
  :root{
    --field-bg:#f1f3f3;     /* light gray fill */
    --label:#2b445b;        /* field title color */
    --mint:#bfe8de;         /* course select bar */
    --invalid:#fde7e7;      /* pinkish invalid fill */
    --btn:#1f3e63;          /* enroll button */
    --btn-text:#ffffff;
    --radius:28px;
    --radius-sm:22px;
    --shadow: 0 10px 22px rgba(0,0,0,.07);
  }

  *{box-sizing:border-box}
  html,body{margin:0}
  body{
    font-family:"Red Hat Display", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    background:transparent; color:#0f1f28;
  }

  .wrap{
    width:min(1200px,100%);
    margin:0 auto;
    padding:22px 16px 28px;
  }

  form{
    display:grid;
    gap:20px 22px;
    grid-template-columns: repeat(12, 1fr);
  }

  .field label{
    display:block;
    font-weight:700;                 /* Bold for titles */
    color:var(--label);
    font-size:14px;
    margin:0 0 8px;
  }
  .req::after{ content:" *"; color:#e05353; font-weight:800 }

  /* Inputs */
  .input, select, textarea{
    width:100%;
    border:none;
    outline:none;
    background:var(--field-bg);
    border-radius:var(--radius);
    padding:18px 20px;
    font-size:16px;
    line-height:1.25;
    font-weight:300;                 /* Light for inputs */
    transition: box-shadow .15s ease, background .15s ease;
  }
  .input:focus, select:focus, textarea:focus{
    box-shadow:0 0 0 3px rgba(35,184,153,.16);
    background:#eef1f1;
  }

  /* Invalid state (no global message; just pink field) */
  .invalid{
    background:var(--invalid) !important;
    box-shadow:none !important;
  }

  /* Phone field container (so the rounded fill matches your design) */
  .phone-shell{
    background:var(--field-bg);
    border-radius:var(--radius);
    padding:10px 12px 10px 12px;
    transition: box-shadow .15s ease, background .15s ease;
  }
  .phone-shell:focus-within{
    box-shadow:0 0 0 3px rgba(35,184,153,.16);
    background:#eef1f1;
  }
  .phone{
    width:100%;
    border:none;
    background:transparent;
    outline:none;
    padding:8px 8px 8px 58px; /* space for flag */
    font-size:16px;
    font-weight:300;
  }

  /* Course mint bar: taller + bold like your screenshot */
  .select-mint{ background:var(--mint) }
  .select-lg{ padding-top:22px; padding-bottom:22px; font-weight:700 }

  textarea{ min-height:140px; border-radius:var(--radius-sm) }

  /* Grid areas to match the screenshot */
  .first { grid-column: span 3; }
  .last  { grid-column: span 3; }
  .age   { grid-column: span 3; }
  .mail  { grid-column: span 3; }

  .phonec{ grid-column: span 6; }
  .branch{ grid-column: span 6; }

  .course{ grid-column: 1 / -1; }
  .msg   { grid-column: 1 / -1; }

  .actions{ grid-column: 1 / -1; display:flex; justify-content:center; }

  /* Enroll button (rounded pill with subtle outer ring like in your shot) */
  button[type="submit"]{
    background:var(--btn);
    color:var(--btn-text);
    border:none;
    padding:16px 38px;
    font-size:18px;
    font-weight:800;
    border-radius:38px;
    cursor:pointer;
    box-shadow:
      0 0 0 4px rgba(39,93,173,.18),  /* soft outer ring */
      var(--shadow);
    transition: transform .08s ease, opacity .2s ease;
  }
  button[type="submit"]:hover{ opacity:.96 }
  button[type="submit"]:active{ transform: translateY(1px) }
  button[disabled]{ opacity:.6; cursor:progress }

  /* Remove default arrow background, keep custom chevron */
  select{
    -webkit-appearance:none; -moz-appearance:none; appearance:none;
    background-image:
      linear-gradient(45deg, transparent 50%, #2b445b 50%),
      linear-gradient(135deg, #2b445b 50%, transparent 50%);
    background-position: calc(100% - 26px) calc(1em + 4px),
                         calc(100% - 20px) calc(1em + 4px);
    background-size:6px 6px, 6px 6px;
    background-repeat:no-repeat;
    padding-right:44px;
  }

  /* Responsive collapse */
  @media (max-width:1100px){
    .first,.last,.age,.mail{ grid-column: span 6; }
  }
  @media (max-width:680px){
    form{ gap:16px }
    .first,.last,.age,.mail,
    .phonec,.branch,
    .course,.msg{ grid-column: 1 / -1; }
    button[type="submit"]{ width:100% }
  }
</style>
</head>
<body>
  <div class="wrap">
    <form id="enrollForm" novalidate>
      <!-- Row 1: 4 fields across -->
      <div class="field first">
        <label class="req">First name</label>
        <input class="input" id="firstName" name="firstName" autocomplete="given-name" required />
      </div>

      <div class="field last">
        <label class="req">Last name</label>
        <input class="input" id="lastName" name="lastName" autocomplete="family-name" required />
      </div>

      <div class="field age">
        <label class="req">Age</label>
        <input class="input" id="age" name="age" type="number" min="3" max="99" inputmode="numeric" required />
      </div>

      <div class="field mail">
        <label class="req">Email</label>
        <input class="input" id="email" name="email" type="email" autocomplete="email" required />
      </div>

      <!-- Row 2: Phone + Branch -->
      <div class="field phonec">
        <label class="req">Phone</label>
        <div class="phone-shell" id="phoneShell">
          <input id="phone" class="phone" name="phone" type="tel" required />
        </div>
      </div>

      <div class="field branch">
        <label class="req">Branch</label>
        <select id="branch" name="branch" required>
          <option value="" selected disabled>Select a branch</option>
          <option>Vake</option>
          <option>Krtsanisi</option>
        </select>
      </div>

      <!-- Course (full width, mint) -->
      <div class="field course">
        <label class="req">Course</label>
        <select id="course" name="course" class="select-mint select-lg" required>
          <option value="" selected disabled>Select a course</option>
          <optgroup label="Children & Teens">
            <option>Sunday School (age:6–10)</option>
            <option>Saturday School (age:6–10)</option>
            <option>General English for Children (age:6–10)</option>
            <option>General English for Teenagers (age: 11–17)</option>
            <option>IELTS</option>
            <option>Private Lessons</option>
          </optgroup>
          <optgroup label="Adults">
            <option>FCE PET CAE</option>
            <option>Professional English</option>
            <option>General English for Adults</option>
          </optgroup>
        </select>
      </div>

      <!-- Message -->
      <div class="field msg">
        <label>Leave a message</label>
        <textarea id="message" name="message" placeholder=""></textarea>
      </div>

      <!-- Submit -->
      <div class="actions">
        <button id="submitBtn" type="submit">Enroll</button>
      </div>
    </form>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/intl-tel-input@19.5.6/build/js/intlTelInput.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/intl-tel-input@19.5.6/build/js/utils.js"></script>
  <script>
    /* ========= Phone with flag ========= */
    const phoneEl = document.getElementById('phone');
    const iti = window.intlTelInput(phoneEl, {
      initialCountry: "ge",
      utilsScript: "https://cdn.jsdelivr.net/npm/intl-tel-input@19.5.6/build/js/utils.js",
      separateDialCode: true,
      preferredCountries: ["ge","tr","ae","gb"],
    });

    /* ========= Validation: highlight fields in pink, no global message ========= */
    const form = document.getElementById('enrollForm');
    const requiredSelectors = [
      '#firstName', '#lastName', '#age', '#email', '#branch', '#course', '#phone'
    ];

    // helper to toggle invalid class
    function setInvalid(el, on){
      if(el.id === 'phone'){
        // wrap shell for phone visual
        const shell = document.getElementById('phoneShell');
        on ? shell.classList.add('invalid') : shell.classList.remove('invalid');
      }else{
        on ? el.classList.add('invalid') : el.classList.remove('invalid');
      }
    }

    function validEmail(v){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }

    // real-time clearing of invalid as user types/selects
    requiredSelectors.forEach(sel => {
      const el = document.querySelector(sel);
      const handler = () => {
        if(el.id === 'phone'){
          if(iti.isValidNumber()) setInvalid(el, false);
        }else if(el.type === 'select-one'){
          if(el.value) setInvalid(el, false);
        }else{
          if(el.value.trim() !== '') setInvalid(el, false);
        }
      };
      el.addEventListener('input', handler);
      el.addEventListener('change', handler);
    });

    form.addEventListener('submit', (e) => {
      e.preventDefault();

      let anyInvalid = false;

      // required presence
      requiredSelectors.forEach(sel => {
        const el = document.querySelector(sel);
        let bad = false;

        if(el.id === 'phone'){
          bad = !iti.isValidNumber();
        }else if(el.type === 'select-one'){
          bad = !el.value;
        }else{
          bad = (el.value.trim() === '');
        }
        setInvalid(el, bad);
        anyInvalid = anyInvalid || bad;
      });

      // specific checks
      const age = document.getElementById('age').value.trim();
      if(isNaN(Number(age)) || Number(age) < 3 || Number(age) > 99){
        setInvalid(document.getElementById('age'), true);
        anyInvalid = true;
      }
      const email = document.getElementById('email').value.trim();
      if(!validEmail(email)){
        setInvalid(document.getElementById('email'), true);
        anyInvalid = true;
      }

      if(anyInvalid) return; // stop here; fields already pink

      // Build payload and send upward to Wix (or your webhook if you add one)
      const payload = {
        firstName: document.getElementById('firstName').value.trim(),
        lastName : document.getElementById('lastName').value.trim(),
        age      : age,
        email    : email,
        phone    : iti.getNumber(),
        phoneCC  : iti.getSelectedCountryData()?.dialCode,
        branch   : document.getElementById('branch').value,
        course   : document.getElementById('course').value,
        message  : document.getElementById('message').value.trim(),
        ts       : new Date().toISOString()
      };

      // Send to parent Wix page (capture with $w('#htmlComponent').onMessage)
      window.parent?.postMessage({ type: "levels-enroll", data: payload }, "*");

      // Reset visual state (keep Georgia as default)
      form.reset();
      iti.setCountry("ge");
      // Clear any invalid highlights
      requiredSelectors.forEach(sel => setInvalid(document.querySelector(sel), false));
    });
  </script>
</body>
</html>

